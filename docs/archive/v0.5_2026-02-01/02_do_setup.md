# DigitalOcean 初期設定（研究室の共通基盤）

狙い：
- 学生アプリの「運用の面倒」を研究室の共通設定に寄せる
- OS/ミドルの保守を最小化（PaaS/Managed中心）

---

## 0) 推奨リージョン
実験対象が日本中心なら、まずは **SGP（シンガポール）** を第一候補に（東京に近く、遅延を抑えやすい）。
- ただし要件（データ越境等）があるなら国内リージョンを検討（利用可能リージョンは要確認）

---

## 1) Team / Project
1. DigitalOceanで Team を作成（研究室用）
2. Project を作成（例：`lab-experiments`）
3. 権限を最小化（Adminは教員/運用担当のみ、学生は必要な範囲）

**必須**：
- 全員 2FA 有効化（SSOが可能ならさらに良い）

---

## 2) Spaces（ファイル/バックアップ置き場）
1. Spaces を有効化（最小プランでOK）
2. 研究室共通で1つの「Spaces subscription」を持ち、バケットを用途別に作るのが運用しやすい

推奨バケット例：
- `lab-uploads`（参加者アップロード）
- `lab-backups`（pg_dump退避）
- `lab-logs`（アプリログの長期保存が必要なら）

---

## 3) Managed PostgreSQL（研究データの保管）
方針：
- **最初は最小（single node）** で開始し、必要になったら拡張
- 「本番・重要データ」は可能なら HA を検討

運用ルール（推奨）：
- 1アプリ = 1DBユーザ（権限を分離）
- DBは `app_xxx` ごとにスキーマ/DBを分ける（誤操作の影響範囲を小さく）

---

## 4) App Platform（アプリの実行基盤）
App Platformは Git 連携でデプロイできます。

基本方針：
- **1アプリ = 1 App Platform App**
- 1本目は最安インスタンスで固定（コストと挙動を読みやすくする）
- `/health` をヘルスチェックに設定（自動再起動・監視の基点）

---

## 5) Uptime（外形監視）
- まずは **各本番アプリに1モニタ**（`/health`）で十分
- 通知先は Email → 慣れたら Slack

